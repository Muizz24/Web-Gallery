# WebGallery REST API Documentation

## Image API

### Create

- description: signs a user in
- request: `POST /signin/`
    - content-type: `application/json`
    - body: object
      - username: (string) username of the user
      - password: (string) password of the user
- response: 200
    - body: user req.body.username has been signed in
- response: 401
	- body: Access denied, wrong username
- response: 401
	- body: Access denied, wrong password
- response: 409
    - body: username req.body.username already exists
- response: 400
	- body: username is missing
- response: 400
	- body: password is missing

```
$ curl -H "Content-Type: application/json" 
       -X POST 
	   -d '{"username":"alice","password":"alice"}'
	   -c cookie.txt localhost:3000/signin/
```

- description: signs a user up
- request: `POST /signup/`
    - content-type: `application/json`
    - body: object
      - username: (string) username of the user
      - password: (string) password of the user
- response: 200
    - body: user req.body.username signed up
- response: 409
    - body: username req.body.username already exists
- response: 400
	- body: username is missing
- response: 400
	- body: password is missing

```	
$ curl -H "Content-Type: application/json"
	   -X POST 
	   -d '{"username":"alice","password":"alice"}'
	   -c cookie.txt localhost:3000/signup/
```

- description: create a new image
- request: `POST /api/images/`
    - content-type: `application/json`
    - body: object
      - title: (string) the title of the image
      - picture: (Object) the data of the picture
- response: 200
    - content-type: `application/json`
    - body: object
      - _id: (string) the image id, autogenerated by database
      - title: (string) the title of the image
      - owner: (string) the authors username
      - date: (Date) the date of whent he image was posted
      - picture: (Object) the uploaded picture data
	  - createdAt: (String) date of when image was created
	  - updatedAt: (String) date of when image was updated
- response: 415
    - body: uploaded file is not an image
``` 
$ curl -X POST 
       -H "Content-Type: `application/json`" 
       -d '{"content":"hello world","author":"me", "file":"image.jpeg"} 
       http://localhost:3000/api/images/
```

### Read

- description: signs a user out
- request: `POST /signout/`
    - content-type: `application/json`
    - body: empty
- response: 200
    - body: redirect

```	
$ curl -b cookie.txt
	   -c cookie.txt localhost:3000/signout/
```

- description: retrieve all images of a specific owner
- request: `GET /api/images/[?owner=null]/`   
- response: 200
    - content-type: `application/json`
    - body: list of objects
      - _id: (string) the image id, autogenerated by database
      - title: (string) the title of the image
      - author: (string) the authors username
      - date: (Date) the date of whent he image was posted
      - picture: (Object) the uploaded picture data
	  - createdAt: (String) date of when image was created
	  - updatedAt: (String) date of when image was updated
 
``` 
$ curl http://localhost:3000/api/images/
``` 

- description: retrieve the image data
- request: `GET /api/images/:id/picture/`
- response: 200
    - content-type: `application/json`
    - body: {}
- response: 404
    - body: image :id does not exist

``` 
$ curl http://localhost:3000/api/images/jed5672jd90xg4awo789/picture/
``` 
  
### Delete
  
- description: delete the image from database
- request: `DELETE /api/images/:id/[?owner=null]`
- response: 200
    - content-type: `application/json`
    - body: (int) response of if the image was deleted (1 means yes, 0 means no images were deleted)
- response: 404
    - body: image :id does not exists
- response: 401
	- body: Forbidden. only user image.owner can delete image

``` 
$ curl -X DELETE
       http://localhost:3000/api/images/jed5672jd90xg4awo789/
```


## Comment API

### Create

- description: create a new comment
- request: `POST /api/images/:id/comments/`
    - content-type: `application/json`
    - body: object
      - content: (string) the content of the comment
      - author: (string) the name of the author
	  - imageId: (string) the id of the image the comment is for
- response: 200
    - content-type: `application/json`
    - body: object
	  - _id: (string) the comments id, autogenerated by database
	  - content: (string) the content of the comment
	  - author: (string) the authors username
	  - date: (Date) the date of when the comment was posted
	  - imageId: (string) the id of the image the comment is for
      - createdAt: (String) date of when comment was created
	  - updatedAt: (String) date of when comment was updated
- response: 404
	-body: image :id does not exists

``` 
$ curl -X POST 
       -H "Content-Type: `application/json`" 
       -d '{"content":"hello world","author":"me","imageId":"jed5672jd90xg4awo789"} 
       http://localhost:3000/api/images/jed5672jd90xg4awo789/comments/
```

### Read

- description: retrieve all comments 
- request: `GET /api/images/:id/comments/all/`   
- response: 200
    - content-type: `application/json`
    - body: list of objects
      - _id: (string) the comments id, autogenerated by database
	  - content: (string) the content of the comment
	  - author: (string) the authors username
	  - date: (Date) the date of when the comment was posted
	  - imageId: (string) the id of the image the comment is for
      - createdAt: (String) date of when comment was created
	  - updatedAt: (String) date of when comment was updated
- response: 404
	-body: image :id does not exists
 
``` 
$ curl http://localhost:3000/api/images/jed5672jd90xg4awo789/comments/all/
``` 

- description: retrieve 10 comments
- request: `GET /api/images/:id/comments/[?page=0&owner=null]`
- response: 200
    - content-type: `application/json`
    - body: list of objects
      - _id: (string) the comments id, autogenerated by database
	  - content: (string) the content of the comment
	  - author: (string) the authors username
	  - date: (Date) the date of when the comment was posted
	  - imageId: (string) the id of the image the comment is for
      - createdAt: (String) date of when comment was created
	  - updatedAt: (String) date of when comment was updated
- response: 404
    - body: image :id does not exist

``` 
$ curl http://localhost:3000/api/images/jed5672jd90xg4awo789/comments/
``` 
  
### Delete

- description: delete the image from database
- request: `DELETE /api/images/:id/comments/:cmtId/`
- response: 200
    - content-type: `application/json`
    - body: (int) response of if the comment was deleted (1 means yes, 0 means no comment was deleted)
- response: 404
    - body: image :id does not exists
- response: 404
    - body: comment :cmtId does not exists
-response: 401
	- body: Forbidden. only user comment.owner or gallery owner can delete comment

``` 
$ curl -X DELETE
       http://localhost:3000/api/images/jed5672jd90xg4awo789/comments/ouvidsncaiu4779/
```

